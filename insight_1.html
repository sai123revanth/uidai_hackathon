<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aadhaar Intelligence: Demographic Saturation</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
--primary-dark: #0f172a;
--accent-blue: #38bdf8;
--card-bg: #1e293b;
--text-muted: #94a3b8;
--success-glow: #10b981;
}

    body {
        background-color: var(--primary-dark);
        color: #f8fafc;
        font-family: 'Inter', system-ui, -apple-system, sans-serif;
        margin: 0;
        padding: 0;
    }

    .dashboard-container {
        padding: 40px 20px;
        max-width: 1400px;
        margin: auto;
    }

    .hero-gradient {
        background: radial-gradient(circle at top right, #1e40af20, transparent);
        padding-bottom: 20px;
    }

    .insight-card {
        background: var(--card-bg);
        border: 1px solid #334155;
        border-radius: 20px;
        padding: 28px;
        height: 100%;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
    }

    .insight-card:hover {
        border-color: var(--accent-blue);
        box-shadow: 0 10px 30px -10px rgba(56, 189, 248, 0.2);
    }

    .stat-value {
        font-size: 3rem;
        font-weight: 800;
        color: var(--accent-blue);
        letter-spacing: -1px;
    }

    .chart-box {
        background: #0f172a;
        border-radius: 12px;
        min-height: 250px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 15px;
        border: 1px solid #1e293b;
    }

    .chart-box img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
    }

    .recommendation-alert {
        border-left: 4px solid var(--accent-blue);
        background: rgba(56, 189, 248, 0.08);
        padding: 16px;
        border-radius: 0 12px 12px 0;
        margin-top: 20px;
    }

    .pincode-badge {
        background: #0f172a;
        border: 1px solid #334155;
        padding: 15px;
        border-radius: 12px;
        transition: 0.2s;
    }

    .pincode-badge:hover {
        background: #1e293b;
        border-color: var(--accent-blue);
    }

    .loading-overlay {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: var(--primary-dark);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.5s ease;
    }

    .spinner-custom {
        width: 50px;
        height: 50px;
        border: 3px solid rgba(56, 189, 248, 0.1);
        border-top: 3px solid var(--accent-blue);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    .hidden { opacity: 0; pointer-events: none; }
</style>


</head>
<body>

<!-- Loading State -->
<div id="loader" class="loading-overlay">
    <div class="spinner-custom mb-3"></div>
    <p class="text-info fw-bold">Syncing with Render API...</p>
</div>

<div class="hero-gradient">
    <div class="dashboard-container">
        <!-- Main Insight Header -->
        <div class="row align-items-center mb-5">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold mb-3">Insight #1: <span class="text-info">Demographic Saturation</span></h1>
                <p class="lead text-secondary">Analyzing the shift from "Identity Expansion" to "Lifecycle Maintenance" across the Indian demographic landscape.</p>
            </div>
            <div class="col-lg-4">
                <div class="insight-card text-center">
                    <div class="small text-muted text-uppercase fw-bold">Mean Saturation Score</div>
                    <div class="stat-value" id="global-sat">--</div>
                    <div class="text-success small fw-bold"><i class="fas fa-check-circle me-1"></i> Optimizing Resources</div>
                </div>
            </div>
        </div>

        <!-- Primary Data Visuals -->
        <div class="row g-4 mb-5">
            <div class="col-lg-6">
                <div class="insight-card">
                    <h4 class="mb-3"><i class="fas fa-chart-line me-2 text-info"></i>Saturation Index Deep-Dive</h4>
                    <p class="text-secondary small">States with a score < 0.2 (Adults per Minor) indicate complete baseline identity coverage.</p>
                    <div class="chart-box" id="sat-chart">
                        <i class="fas fa-circle-notch fa-spin text-muted"></i>
                    </div>
                    <div class="recommendation-alert">
                        <h6 class="text-info fw-bold small"><i class="fas fa-bolt me-2"></i>STRATEGIC PIVOT</h6>
                        <p class="small mb-0">Reallocate 40% of adult outreach budget to neonatal (0-5) 'Baal Aadhaar' specialized mobile units.</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-6">
                <div class="insight-card">
                    <h4 class="mb-3"><i class="fas fa-users-rays me-2 text-info"></i>Baal Aadhaar Champions</h4>
                    <div class="table-responsive">
                        <table class="table table-dark table-borderless table-hover align-middle small">
                            <thead>
                                <tr class="text-muted border-bottom border-secondary">
                                    <th>STATE</th>
                                    <th class="text-end">BAP SCORE</th>
                                </tr>
                            </thead>
                            <tbody id="champions-table">
                                <!-- Dynamic Rows -->
                            </tbody>
                        </table>
                    </div>
                    <div class="chart-box" id="vel-chart">
                        <i class="fas fa-circle-notch fa-spin text-muted"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Identity Deserts -->
        <div class="row">
            <div class="col-12">
                <div class="insight-card">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3><i class="fas fa-satellite-dish me-2 text-info"></i>Identity Deserts</h3>
                        <span class="badge bg-info text-dark">HYPER-LOCAL HOTSPOTS</span>
                    </div>
                    <p class="text-secondary mb-4">Pincodes requiring immediate infrastructure deployment based on high enrolment demand density.</p>
                    <div class="row g-3" id="pincode-grid">
                        <!-- Dynamic Pincodes -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="py-5 text-center text-muted small border-top border-secondary">
    <p>© 2026 Aadhaar Vision Intelligence System • Powered by Render API Engine</p>
</footer>

<script>
    const RENDER_URL = "https://insight-1-zvvk.onrender.com/api/data";

    async function initDashboard() {
        try {
            const response = await fetch(RENDER_URL);
            if (!response.ok) throw new Error("API Offline");
            const data = await response.json();

            // 1. Update Global Stat
            document.getElementById('global-sat').innerText = data.global_sat;

            // 2. Inject Charts (Base64)
            document.getElementById('sat-chart').innerHTML = `<img src="data:image/png;base64,${data.plot_s}" alt="Saturation Plot">`;
            document.getElementById('vel-chart').innerHTML = `<img src="data:image/png;base64,${data.plot_v}" alt="Velocity Plot">`;

            // 3. Populating Table
            const tableBody = document.getElementById('champions-table');
            tableBody.innerHTML = data.champions.map(c => `
                <tr>
                    <td class="fw-bold">${c.state}</td>
                    <td class="text-end text-info fw-bold">${c.bap_score.toFixed(2)}%</td>
                </tr>
            `).join('');

            // 4. Populating Pincode Grid
            const pinGrid = document.getElementById('pincode-grid');
            pinGrid.innerHTML = data.pincodes.slice(0, 12).map(p => `
                <div class="col-6 col-md-3 col-lg-2">
                    <div class="pincode-badge text-center">
                        <div class="small text-muted">PIN</div>
                        <div class="fw-bold text-info">${p.pincode}</div>
                        <div class="x-small text-secondary mt-1">${p.total_enrolments} units</div>
                    </div>
                </div>
            `).join('');

            // Remove Loader
            document.getElementById('loader').classList.add('hidden');

        } catch (err) {
            console.error("Dashboard failed to sync:", err);
            document.getElementById('loader').innerHTML = `
                <div class="text-center p-4">
                    <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                    <h4 class="text-white">API Connection Failed</h4>
                    <p class="text-muted">Ensure the server at ${RENDER_URL} is running.</p>
                    <button onclick="location.reload()" class="btn btn-info btn-sm mt-2">Retry Sync</button>
                </div>
            `;
        }
    }

    // Initialize on load
    window.addEventListener('load', initDashboard);
</script>


</body>
</html>